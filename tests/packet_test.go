package tests

import (
	"encoding/binary"
	"encoding/hex"
	"fmt"
	"testing"

	"github.com/chnykn/tcpkit"
)

/*
var pkt = []byte{0x28, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x00, 0x82, 0x00, 0x10,
	0x5A, 0x4A, 0x38, 0x30, 0x30, 0x30, 0x5F, 0x32, 0x30, 0x31, 0x34, 0x30, 0x34,
	0x30, 0x34, 0x41, 0x93, 0x29}
*/

var body = []byte{ /* 0x28, */ 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x00, 0x82, 0x00, 0x10,
	0x5A, 0x4A, 0x38, 0x30, 0x30, 0x30, 0x5F, 0x32, 0x30, 0x31, 0x34, 0x30, 0x34,
	0x30, 0x34, 0x41 /* , 0x93, 0x29 */} // sum = 0x93

var id = []byte{0x88, 0x88, 0x88, 0x88, 0x88, 0x88}

var size = []byte{0x00, 0x10}

var content = []byte{ /* 0x28, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x00, 0x82, 0x00, 0x10,*/
	0x5A, 0x4A, 0x38, 0x30, 0x30, 0x30, 0x5F, 0x32, 0x30, 0x31, 0x34, 0x30, 0x34,
	0x30, 0x34, 0x41 /* , 0x93, 0x29 */}

//-------------------------------------------

func TestEncode(t *testing.T) {
	idStr := hex.EncodeToString(id)
	fmt.Printf("id=%s\n", idStr)

	cont := string(content)
	fmt.Printf("cont=%s\n", cont)

	sizeInt := binary.BigEndian.Uint16(size)
	fmt.Printf("size=%v\n", sizeInt)
}

func TestCheckSum(t *testing.T) {
	sum := tcpkit.CheckSum8(body, 0, -1)
	fmt.Printf("%x, %v\n", sum, sum == 0x93)
}

/******************************************************
*函数名称:CheckSum8
*输   入:buf 要校验的数据
        len 校验数据的长
*输   出:校验和
*功   能:校验和-8
*******************************************************/
/*
UCHAR CheckSum8(UCHAR *buf,UINT len) {
	UINT    i=0;
	UCHAR Sum=0;

	for (i=0;i<len;i++)	{
		Sum+=*buf++;
	}

	return Sum;
}
*/
